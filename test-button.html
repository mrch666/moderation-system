<!DOCTYPE html>
<html>
<head>
    <title>–¢–µ—Å—Ç –∫–Ω–æ–ø–∫–∏ –º–æ–¥–µ—Ä–∞—Ü–∏–∏</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        button { margin: 10px; padding: 10px 20px; font-size: 16px; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>üß™ –¢–µ—Å—Ç –∫–Ω–æ–ø–∫–∏ –º–æ–¥–µ—Ä–∞—Ü–∏–∏</h1>
    
    <div>
        <h3>1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–∏ moderate:</h3>
        <button onclick="testModerateFunction()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é moderate()</button>
        <div id="test1"></div>
    </div>
    
    <div>
        <h3>2. –¢–µ—Å—Ç–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏:</h3>
        <button onclick="moderate('test-uuid-123', 'approved')">‚úÖ –¢–µ—Å—Ç Approve</button>
        <button onclick="moderate('test-uuid-456', 'rejected')">‚ùå –¢–µ—Å—Ç Reject</button>
        <div id="test2"></div>
    </div>
    
    <div>
        <h3>3. –ü—Ä–æ–≤–µ—Ä–∫–∞ API_URL –∏ API_KEY:</h3>
        <button onclick="testConfig()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é</button>
        <div id="test3"></div>
    </div>
    
    <div>
        <h3>4. –ü—Ä–æ–≤–µ—Ä–∫–∞ fetch:</h3>
        <button onclick="testFetch()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å fetch –∑–∞–ø—Ä–æ—Å</button>
        <div id="test4"></div>
    </div>
    
    <div>
        <h3>5. –°—Å—ã–ª–∫–∏:</h3>
        <p><a href="http://localhost:8080" target="_blank">–û—Å–Ω–æ–≤–Ω–æ–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å</a></p>
        <p><a href="http://localhost:8080/config.js" target="_blank">config.js</a></p>
    </div>

    <script>
        // –ó–∞–≥—Ä—É–∂–∞–µ–º config.js
        const script = document.createElement('script');
        script.src = '/config.js';
        script.onload = function() {
            console.log('‚úÖ config.js –∑–∞–≥—Ä—É–∂–µ–Ω:', window.MODERATION_CONFIG);
            // –ö–æ–ø–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ simple-index.html
            copyFunctionsFromMainPage();
        };
        document.head.appendChild(script);
        
        function copyFunctionsFromMainPage() {
            // –ü–æ–ø—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
            fetch('/')
                .then(response => response.text())
                .then(html => {
                    // –ò—â–µ–º JavaScript –∫–æ–¥
                    const scriptMatch = html.match(/<script>([\s\S]*?)<\/script>/);
                    if (scriptMatch) {
                        console.log('–ù–∞–π–¥–µ–Ω JavaScript –∫–æ–¥ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ');
                    }
                })
                .catch(error => {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞:', error);
                });
        }
        
        function testModerateFunction() {
            if (typeof moderate === 'function') {
                document.getElementById('test1').innerHTML = 
                    '<span class="success">‚úÖ –§—É–Ω–∫—Ü–∏—è moderate() —Å—É—â–µ—Å—Ç–≤—É–µ—Ç</span>';
            } else {
                document.getElementById('test1').innerHTML = 
                    '<span class="error">‚ùå –§—É–Ω–∫—Ü–∏—è moderate() –Ω–µ –Ω–∞–π–¥–µ–Ω–∞</span>';
            }
        }
        
        function testConfig() {
            const config = window.MODERATION_CONFIG || {};
            const html = `
                <div>
                    <p>API_URL: <code>${config.API_URL || '–Ω–µ –Ω–∞–π–¥–µ–Ω'}</code></p>
                    <p>API_KEY: <code>${config.API_KEY ? '***' + config.API_KEY.slice(-6) : '–Ω–µ –Ω–∞–π–¥–µ–Ω'}</code></p>
                    <p>DEBUG: ${config.DEBUG || '–Ω–µ –Ω–∞–π–¥–µ–Ω'}</p>
                </div>
            `;
            document.getElementById('test3').innerHTML = html;
        }
        
        function testFetch() {
            const url = (window.MODERATION_CONFIG?.API_URL || '/api') + '/health';
            fetch(url)
                .then(response => {
                    document.getElementById('test4').innerHTML = 
                        `<span class="success">‚úÖ Fetch —Ä–∞–±–æ—Ç–∞–µ—Ç: ${response.status}</span>`;
                })
                .catch(error => {
                    document.getElementById('test4').innerHTML = 
                        `<span class="error">‚ùå Fetch –æ—à–∏–±–∫–∞: ${error.message}</span>`;
                });
        }
        
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é moderate –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
        if (typeof moderate === 'undefined') {
            window.moderate = function(id, status) {
                alert(`–§—É–Ω–∫—Ü–∏—è moderate –≤—ã–∑–≤–∞–Ω–∞: id=${id}, status=${status}`);
                console.log('moderate called:', id, status);
                
                // –ü—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–∞
                const config = window.MODERATION_CONFIG || {};
                const apiUrl = config.API_URL || '/api';
                const apiKey = config.API_KEY || 'test_api_key_123456';
                
                fetch(`${apiUrl}/moderation/${id}/moderate`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-API-Key': apiKey
                    },
                    body: JSON.stringify({ status })
                })
                .then(response => response.json())
                .then(data => {
                    alert(`–†–µ–∑—É–ª—å—Ç–∞—Ç: ${data.success ? '–£—Å–ø–µ—Ö' : '–û—à–∏–±–∫–∞'}`);
                })
                .catch(error => {
                    alert(`–û—à–∏–±–∫–∞: ${error.message}`);
                });
            };
            
            console.log('‚ö†Ô∏è –§—É–Ω–∫—Ü–∏—è moderate –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∞');
        }
    </script>
</body>
</html>