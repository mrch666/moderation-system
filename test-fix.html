<!DOCTYPE html>
<html>
<head>
    <title>–¢–µ—Å—Ç –ø—Ä–æ–∫—Å–∏ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .success { color: green; }
        .error { color: red; }
        .test { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
    </style>
</head>
<body>
    <h1>üß™ –¢–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã –º–æ–¥–µ—Ä–∞—Ü–∏–∏</h1>
    
    <div class="test">
        <h3>1. –ü—Ä–æ–≤–µ—Ä–∫–∞ config.js</h3>
        <div id="config-test">–ü—Ä–æ–≤–µ—Ä—è–µ–º...</div>
    </div>
    
    <div class="test">
        <h3>2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∫—Å–∏ API</h3>
        <div id="proxy-test">–ü—Ä–æ–≤–µ—Ä—è–µ–º...</div>
    </div>
    
    <div class="test">
        <h3>3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—á–µ—Ä–µ–¥–∏ —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏</h3>
        <div id="queue-test">–ü—Ä–æ–≤–µ—Ä—è–µ–º...</div>
    </div>
    
    <div class="test">
        <h3>4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞</h3>
        <p>–û—Ç–∫—Ä–æ–π—Ç–µ: <a href="http://localhost:8080" target="_blank">http://localhost:8080</a></p>
        <p>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å (F12) –Ω–∞ –æ—à–∏–±–∫–∏</p>
    </div>

    <script>
        async function testConfig() {
            try {
                const response = await fetch('/config.js');
                const text = await response.text();
                const match = text.match(/API_URL["']:\s*["']([^"']+)["']/);
                if (match && match[1] === '/api') {
                    document.getElementById('config-test').innerHTML = 
                        '<span class="success">‚úÖ config.js –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π: API_URL = "/api"</span>';
                    return true;
                } else {
                    document.getElementById('config-test').innerHTML = 
                        `<span class="error">‚ùå config.js –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π: ${match ? match[1] : '–Ω–µ –Ω–∞–π–¥–µ–Ω'}</span>`;
                    return false;
                }
            } catch (error) {
                document.getElementById('config-test').innerHTML = 
                    `<span class="error">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ config.js: ${error.message}</span>`;
                return false;
            }
        }
        
        async function testProxy() {
            try {
                const response = await fetch('/api/health');
                const data = await response.json();
                if (data.status === 'OK') {
                    document.getElementById('proxy-test').innerHTML = 
                        '<span class="success">‚úÖ –ü—Ä–æ–∫—Å–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç: ' + data.service + '</span>';
                    return true;
                } else {
                    document.getElementById('proxy-test').innerHTML = 
                        `<span class="error">‚ùå –ü—Ä–æ–∫—Å–∏ –≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É: ${JSON.stringify(data)}</span>`;
                    return false;
                }
            } catch (error) {
                document.getElementById('proxy-test').innerHTML = 
                    `<span class="error">‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–∫—Å–∏: ${error.message}</span>`;
                return false;
            }
        }
        
        async function testQueue() {
            try {
                const response = await fetch('/api/moderation/queue?limit=1', {
                    headers: { 'X-API-Key': 'test_api_key_123456' }
                });
                const data = await response.json();
                if (data.success) {
                    document.getElementById('queue-test').innerHTML = 
                        `<span class="success">‚úÖ –û—á–µ—Ä–µ–¥—å —Ä–∞–±–æ—Ç–∞–µ—Ç: ${data.pagination?.total || 0} —ç–ª–µ–º–µ–Ω—Ç–æ–≤</span>`;
                    return true;
                } else {
                    document.getElementById('queue-test').innerHTML = 
                        `<span class="error">‚ùå –û—à–∏–±–∫–∞ –æ—á–µ—Ä–µ–¥–∏: ${JSON.stringify(data)}</span>`;
                    return false;
                }
            } catch (error) {
                document.getElementById('queue-test').innerHTML = 
                    `<span class="error">‚ùå –û—à–∏–±–∫–∞ –æ—á–µ—Ä–µ–¥–∏: ${error.message}</span>`;
                return false;
            }
        }
        
        async function runTests() {
            console.log('üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã...');
            
            const configOk = await testConfig();
            const proxyOk = await testProxy();
            const queueOk = await testQueue();
            
            if (configOk && proxyOk && queueOk) {
                console.log('‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã!');
                console.log('üåê –û—Ç–∫—Ä–æ–π—Ç–µ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å: http://localhost:8080');
            } else {
                console.log('‚ùå –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç–µ—Å—Ç—ã –Ω–µ –ø—Ä–æ–π–¥–µ–Ω—ã');
            }
        }
        
        // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        runTests();
    </script>
</body>
</html>